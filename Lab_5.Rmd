---
title: "Lab 5"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## 1.1 and 1.2
```{r, eval = FALSE, echo = FALSE, message= FALSE}
library(tidyverse)
icelandic <- read.csv("https://goo.gl/7gIjvK")
icelandic %>% 
  group_by(aspiration, speaker) %>%
  summarise(mean = mean(vowel.dur),
            CI = 1.96*sd(vowel.dur)/sqrt(length(vowel.dur)))
```

## 1.3
```{r, eval = FALSE, echo = FALSE}
icelandic %>% 
  group_by(aspiration, speaker) %>%
  summarise(mean = mean(vowel.dur),
            CI = 1.96*sd(vowel.dur)/sqrt(length(vowel.dur))) %>% 
    ggplot(aes(aspiration, mean))+
  geom_point()+
  geom_errorbar(aes(ymin= mean-CI,
                    ymax = mean+CI), width = 0.3)+
  facet_wrap(~speaker)+
  labs(title = "Mean vowel duration with 95% confidence interval",
       caption = "Data from (Coretta 2017)")
  
```

## 1.4
```{r, eval = FALSE, echo = FALSE}
icelandic %>% 
  ggplot(aes(vowel.dur, fill = aspiration, color = aspiration))+
  geom_density(alpha = 0.4)+
  geom_rug()+
  facet_wrap(~speaker)+
  labs(title = "Vowel duration density plot",
       caption = "Data from (Coretta 2017)",
       x = "vowel duration")
```
```{r, eval = FALSE, echo = FALSE}
icelandic %>% 
  ggplot(aes(sample = vowel.dur, color = aspiration))+
  geom_qq()+
  facet_wrap(~speaker)+
  labs(title = "Vowel duration density plot",
       caption = "Data from (Coretta 2017)")
```


```{r, eval = FALSE, echo = FALSE}
icelandic %>%
  group_by(speaker, aspiration) %>% 
  mutate(min = quantile(vowel.dur, 0.25) - 1.5*IQR(vowel.dur),
         max = quantile(vowel.dur, 0.75) + 1.5*IQR(vowel.dur)) %>%
  filter(vowel.dur > min, vowel.dur < max) %>% 
  ggplot(aes(vowel.dur, fill = aspiration, color = aspiration))+
  geom_density(alpha = 0.4)+
  geom_rug()+
  facet_wrap(~speaker)+
  labs(title = "Vowel duration density plot",
       caption = "Data from (Coretta 2017)",
       x = "vowel duration")
```

```{r, eval = FALSE, echo = FALSE}
icelandic %>%
  group_by(speaker, aspiration) %>% 
  mutate(min = quantile(vowel.dur, 0.25) - 1.5*IQR(vowel.dur),
         max = quantile(vowel.dur, 0.75) + 1.5*IQR(vowel.dur)) %>%
  filter(vowel.dur > min, vowel.dur < max) %>% 
  ggplot(aes(sample = vowel.dur, color = aspiration))+
  geom_qq()+
  facet_wrap(~speaker)+
  labs(title = "Vowel duration density plot",
       caption = "Data from (Coretta 2017)")
```

